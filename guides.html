<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Addons & Guides | TITAN Guild</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="titan logo png.png">
    <style>
        .guides-page { padding-top: 70px; min-height: 100vh; }

        .guide-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }
        .guide-tab {
            padding: 8px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .guide-tab:hover { background: var(--bg-tertiary); }
        .guide-tab.active { background: var(--horde-red); border-color: var(--horde-red); color: white; }

        /* Compact addon list */
        .addon-list { display: flex; flex-direction: column; gap: 8px; }

        .addon-item {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 16px;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
        }
        .addon-item.required { border-left: 3px solid var(--horde-red); }

        .addon-item-info h4 {
            font-size: 0.95rem;
            color: var(--text-primary);
            margin-bottom: 2px;
        }
        .addon-item-info p {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        .addon-tag {
            padding: 2px 8px;
            background: var(--horde-red);
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            color: white;
        }
        .addon-item .btn {
            padding: 6px 14px;
            font-size: 0.8rem;
        }

        .section-title {
            font-size: 1.1rem;
            color: var(--horde-red-light);
            margin: 24px 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-subtle);
        }
        .section-title:first-child { margin-top: 0; }

        /* Installation compact */
        .install-box {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            padding: 16px;
        }
        .install-box code {
            display: block;
            background: var(--bg-primary);
            padding: 8px 12px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.85rem;
            color: var(--horde-red-light);
            margin: 8px 0;
        }
        .install-box p { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.5; }

        /* Consumables compact grid */
        .consumables-compact {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }
        .consumable-box {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 8px;
            padding: 12px;
        }
        .consumable-box h4 {
            font-size: 0.9rem;
            color: var(--horde-red-light);
            margin-bottom: 8px;
        }
        .consumable-box ul {
            list-style: none;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        .consumable-box li { padding: 2px 0; }
        .consumable-box a.item-link {
            color: var(--horde-red-light);
            text-decoration: none;
        }
        .consumable-box a.item-link:hover {
            text-decoration: underline;
        }

        .guide-section { display: none; }
        .guide-section.active { display: block; }

        @media (max-width: 768px) {
            .addon-item { grid-template-columns: 1fr; gap: 8px; }
            .addon-item .btn { width: 100%; }
        }

        /* WeakAuras Grid */
        .wa-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 8px;
        }
        .wa-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 14px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 6px;
        }
        .wa-item:hover { border-color: var(--horde-red); }
        .wa-name {
            font-size: 0.85rem;
            color: var(--text-primary);
        }
        .wa-link {
            padding: 4px 12px;
            background: var(--horde-red);
            border-radius: 4px;
            color: white;
            text-decoration: none;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .wa-link:hover { background: #a01830; }
    </style>
</head>
<body>
    <nav class="nav" id="nav">
        <div class="nav-inner">
            <a href="/" class="nav-brand">
                <img src="titan logo png.png" alt="Titan Logo" class="nav-logo">
                <span class="nav-title">TITAN</span>
            </a>
            <ul class="nav-links">
                <li><a href="/" class="nav-link">Home</a></li>
                <!-- <li><a href="raids.html" class="nav-link">Raids</a></li> -->
                <li><a href="guild.html" class="nav-link">Guild</a></li>
                <li><a href="top-parsers.html" class="nav-link">Top Parsers</a></li>
                <li><a href="bis.html" class="nav-link">BiS List</a></li>
                <li><a href="guides.html" class="nav-link active">Guides</a></li>
                <li><a href="join.html" class="nav-link">Join</a></li>
            </ul>
            <div class="nav-cta">
                <a href="join.html" class="btn btn-primary">Join Guild</a>
            </div>
            <button class="nav-toggle" id="navToggle"><span></span><span></span><span></span></button>
        </div>
    </nav>

    <div class="guides-page">
        <div class="page-header">
            <div class="container">
                <h1>Addons & Guides</h1>
                <p>WotLK 3.3.5 Warmane essentials</p>
            </div>
        </div>

        <div class="container" style="padding: 24px 0;">
            <div class="guide-tabs">
                <button class="guide-tab active" data-section="addons">Addons</button>
                <button class="guide-tab" data-section="install">Installation</button>
                <button class="guide-tab" data-section="weakauras">WeakAuras</button>
                <button class="guide-tab" data-section="consumables">Consumables</button>
            </div>

            <!-- ADDONS SECTION -->
            <div class="guide-section active" id="addons">
                <div id="addons-loading" style="text-align: center; padding: 40px; color: var(--text-muted);">Loading addons...</div>
                <div id="addons-content"></div>

                <h3 class="section-title">Download Sites</h3>
                <div class="addon-list">
                    <div class="addon-item">
                        <div class="addon-item-info">
                            <h4>Felbite.com</h4>
                            <p>Dedicated 3.3.5 addon repository. Verified compatible versions.</p>
                        </div>
                        <a href="https://felbite.com/addons/" target="_blank" class="btn btn-secondary">Visit</a>
                    </div>
                    <div class="addon-item">
                        <div class="addon-item-info">
                            <h4>Warmane Forums - Addon Section</h4>
                            <p>Community-tested addons specifically for Warmane servers.</p>
                        </div>
                        <a href="https://forum.warmane.com/forumdisplay.php?f=83" target="_blank" class="btn btn-secondary">Visit</a>
                    </div>
                </div>
            </div>

            <!-- INSTALLATION SECTION -->
            <div class="guide-section" id="install">
                <h3 class="section-title">Quick Installation</h3>
                <div class="install-box">
                    <p><strong>1.</strong> Download addon (usually a .zip file)</p>
                    <p><strong>2.</strong> Extract the folder</p>
                    <p><strong>3.</strong> Copy to your AddOns folder:</p>
                    <code>C:\Warmane\Interface\AddOns\</code>
                    <p><strong>4.</strong> Restart WoW, click "AddOns" at character select</p>
                    <p><strong>5.</strong> Check "Load out of date AddOns" if addon appears red</p>
                </div>

                <h3 class="section-title">Troubleshooting</h3>
                <div class="install-box">
                    <p><strong>Addon not showing?</strong> Make sure you copied the inner folder (the one with .toc file), not the outer zip folder.</p>
                    <p style="margin-top: 8px;"><strong>Lua errors?</strong> Type <code style="display: inline; margin: 0;">/console scriptErrors 0</code> to hide, but try updating the addon first.</p>
                    <p style="margin-top: 8px;"><strong>Wrong version?</strong> WotLK 3.3.5 addons have interface version 30300. Retail addons won't work.</p>
                </div>
            </div>

            <!-- WEAKAURAS SECTION -->
            <div class="guide-section" id="weakauras">
                <h3 class="section-title">How to Import WeakAuras</h3>
                <div class="install-box">
                    <p><strong>1.</strong> Install WeakAuras addon (link in Addons tab)</p>
                    <p><strong>2.</strong> Click "Wago" to open wago.io OR click "Copy" to copy import string directly</p>
                    <p><strong>3.</strong> In-game type <code style="display: inline; margin: 0;">/wa</code> → Import → Paste</p>
                </div>

                <div id="weakauras-loading" style="text-align: center; padding: 40px; color: var(--text-muted);">Loading WeakAuras...</div>
                <div id="weakauras-content"></div>
            </div>

            <!-- CONSUMABLES SECTION -->
            <div class="guide-section" id="consumables">
                <h3 class="section-title">Raid Consumables Checklist</h3>
                <p style="color: var(--text-muted); margin-bottom: 16px;">Bring these to every ICC/RS run. Links go to Wowhead for recipes/sources.</p>

                <div class="consumables-compact">
                    <div class="consumable-box">
                        <h4>Flasks (1hr, persists through death)</h4>
                        <ul>
                            <li><a href="https://www.wowhead.com/wotlk/item=46377" target="_blank" class="item-link">Flask of Endless Rage</a> - Physical DPS</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=46376" target="_blank" class="item-link">Flask of the Frost Wyrm</a> - Casters</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=46379" target="_blank" class="item-link">Flask of Stoneblood</a> - Tanks</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=46378" target="_blank" class="item-link">Flask of Pure Mojo</a> - Healers (mana regen)</li>
                        </ul>
                    </div>
                    <div class="consumable-box">
                        <h4>Food Buffs (30min)</h4>
                        <ul>
                            <li><a href="https://www.wowhead.com/wotlk/item=43015" target="_blank" class="item-link">Fish Feast</a> - Raid drop (80 AP/46 SP)</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=42996" target="_blank" class="item-link">Dragonfin Filet</a> - 40 Str + 40 Stam</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=34767" target="_blank" class="item-link">Firecracker Salmon</a> - 46 SP + 40 Stam</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=42995" target="_blank" class="item-link">Hearty Rhino</a> - 40 ArP + 40 Stam</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=34769" target="_blank" class="item-link">Imperial Manta Steak</a> - 40 Haste</li>
                        </ul>
                    </div>
                    <div class="consumable-box">
                        <h4>Potions (Pre-pot + 1 during)</h4>
                        <ul>
                            <li><a href="https://www.wowhead.com/wotlk/item=40211" target="_blank" class="item-link">Potion of Speed</a> - 500 Haste/15s</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=40212" target="_blank" class="item-link">Potion of Wild Magic</a> - 200 Crit+SP</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=40093" target="_blank" class="item-link">Indestructible Potion</a> - 3500 Armor/2min</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=33448" target="_blank" class="item-link">Runic Mana Potion</a> - 4200-4400 Mana</li>
                        </ul>
                    </div>
                    <div class="consumable-box">
                        <h4>Utility</h4>
                        <ul>
                            <li><a href="https://www.wowhead.com/wotlk/item=43468" target="_blank" class="item-link">Drums of Forgotten Kings</a> - 8% stats</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=43466" target="_blank" class="item-link">Drums of the Wild</a> - Mark of Wild</li>
                            <li><a href="https://www.wowhead.com/wotlk/item=34722" target="_blank" class="item-link">Heavy Frostweave Bandage</a></li>
                            <li><a href="https://www.wowhead.com/wotlk/item=36770" target="_blank" class="item-link">Scroll of Strength VIII</a></li>
                        </ul>
                    </div>
                </div>

                <h3 class="section-title">How Much to Bring</h3>
                <div class="install-box">
                    <p><strong>Per ICC Full Clear (~2-3 hours):</strong></p>
                    <ul style="margin-top: 8px; color: var(--text-secondary); font-size: 0.9rem; padding-left: 20px;">
                        <li>3x Flask (or mats for 3)</li>
                        <li>20x Personal food (backup if no feast)</li>
                        <li>20x Potions (pre-pot every boss = 12 + wipes)</li>
                        <li>10x Bandages</li>
                    </ul>
                </div>

                <div class="install-box" style="margin-top: 16px; border-left: 3px solid var(--horde-red);">
                    <p><strong style="color: var(--horde-red-light);">TITAN Raid Rule:</strong> Flask up before first pull. Pre-pot on every boss. No excuses.</p>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-promo" style="text-align: center; padding: 16px 0; margin-bottom: 16px; border-bottom: 1px solid var(--border-subtle);">
                <p style="color: var(--text-muted); font-size: 0.9rem;">Want your own website, iOS/Android app, or custom addon built? Add me on Discord: <span style="color: var(--horde-red-light); font-weight: 600;">abdellatiff</span></p>
            </div>
            <div class="footer-bottom" style="border-top: none; padding-top: 0;">
                <p>&copy; 2026 T I T A N Guild. Warmane Icecrown.</p>
            </div>
        </div>
    </footer>

    <script>
        document.querySelectorAll('.guide-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.guide-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.guide-section').forEach(s => s.classList.remove('active'));
                this.classList.add('active');
                document.getElementById(this.dataset.section).classList.add('active');
            });
        });

        // Mobile nav toggle
        document.getElementById('navToggle').addEventListener('click', function() {
            this.classList.toggle('active');
            document.querySelector('.nav-links').classList.toggle('active');
        });

        window.addEventListener('scroll', () => {
            document.getElementById('nav').classList.toggle('scrolled', window.scrollY > 50);
        });

        // Load Addons from API
        async function loadAddons() {
            try {
                const response = await fetch('/api/guides?type=addons');
                const data = await response.json();
                const addons = data.items || [];

                document.getElementById('addons-loading').style.display = 'none';

                if (addons.length === 0) {
                    document.getElementById('addons-content').innerHTML = '<p style="color: var(--text-muted);">No addons found.</p>';
                    return;
                }

                // Group by category
                const groups = {};
                addons.forEach(addon => {
                    const cat = addon.category || 'General';
                    if (!groups[cat]) groups[cat] = [];
                    groups[cat].push(addon);
                });

                // Define category order
                const categoryOrder = ['Required', 'Recommended', 'Collection', 'General'];
                const sortedCategories = Object.keys(groups).sort((a, b) => {
                    const aIdx = categoryOrder.indexOf(a);
                    const bIdx = categoryOrder.indexOf(b);
                    return (aIdx === -1 ? 999 : aIdx) - (bIdx === -1 ? 999 : bIdx);
                });

                let html = '';
                sortedCategories.forEach(category => {
                    const isRequired = category === 'Required';
                    html += `<h3 class="section-title">${category} Addons</h3>`;
                    html += '<div class="addon-list">';
                    groups[category].forEach(addon => {
                        html += `
                            <div class="addon-item ${isRequired ? 'required' : ''}">
                                <div class="addon-item-info">
                                    <h4>${addon.name} ${isRequired ? '<span class="addon-tag">REQUIRED</span>' : ''}</h4>
                                    <p>${addon.description || ''}</p>
                                </div>
                                ${addon.url ? `<a href="${addon.url}" target="_blank" class="btn ${isRequired ? 'btn-primary' : 'btn-secondary'}">Download</a>` : ''}
                            </div>
                        `;
                    });
                    html += '</div>';
                });

                document.getElementById('addons-content').innerHTML = html;
            } catch (error) {
                document.getElementById('addons-loading').innerHTML = '<p style="color: #ef4444;">Failed to load addons</p>';
            }
        }

        // Load WeakAuras from API
        async function loadWeakAuras() {
            try {
                const response = await fetch('/api/guides?type=weakauras');
                const data = await response.json();
                const weakauras = data.items || [];

                document.getElementById('weakauras-loading').style.display = 'none';

                if (weakauras.length === 0) {
                    document.getElementById('weakauras-content').innerHTML = '<p style="color: var(--text-muted);">No WeakAuras found.</p>';
                    return;
                }

                // Group by category
                const groups = {};
                weakauras.forEach(wa => {
                    const cat = wa.category || 'General';
                    if (!groups[cat]) groups[cat] = [];
                    groups[cat].push(wa);
                });

                // Define category order
                const categoryOrder = ['DPS', 'Healer', 'Tank', 'ICC Boss', 'Utility', 'Raid Leader', 'General'];
                const sortedCategories = Object.keys(groups).sort((a, b) => {
                    const aIdx = categoryOrder.indexOf(a);
                    const bIdx = categoryOrder.indexOf(b);
                    return (aIdx === -1 ? 999 : aIdx) - (bIdx === -1 ? 999 : bIdx);
                });

                let html = '';
                sortedCategories.forEach(category => {
                    html += `<h3 class="section-title">${category} WeakAuras</h3>`;
                    html += '<div class="wa-grid">';
                    groups[category].forEach(wa => {
                        const hasContent = wa.content && wa.content.length > 10;
                        html += `
                            <div class="wa-item">
                                <span class="wa-name">${wa.name}</span>
                                <div style="display: flex; gap: 4px;">
                                    ${hasContent ? `<button class="wa-link" style="background: #22c55e;" onclick="copyWA('${wa.id}')">Copy</button>` : ''}
                                    ${wa.url ? `<a href="${wa.url}" target="_blank" class="wa-link">Wago</a>` : ''}
                                </div>
                            </div>
                        `;
                    });
                    html += '</div>';
                });

                document.getElementById('weakauras-content').innerHTML = html;

                // Store WA data for copy function
                window.waData = weakauras;
            } catch (error) {
                document.getElementById('weakauras-loading').innerHTML = '<p style="color: #ef4444;">Failed to load WeakAuras</p>';
            }
        }

        // Copy WeakAura import string
        function copyWA(waId) {
            const wa = window.waData?.find(w => w.id === waId);
            if (wa && wa.content) {
                navigator.clipboard.writeText(wa.content).then(() => {
                    alert('WeakAura import string copied! Paste it in-game with /wa → Import');
                }).catch(() => {
                    // Fallback for older browsers
                    const textarea = document.createElement('textarea');
                    textarea.value = wa.content;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('WeakAura import string copied!');
                });
            }
        }

        // Load data on page load
        loadAddons();
        loadWeakAuras();
    </script>
</body>
</html>
